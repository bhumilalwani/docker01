<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
</head>
<body>
    <div class="bg-zinc-800 w-full h-full">
        <h3 class="font-black text-zinc-100 text-center p-4 text-2xl">Login to your account</h3>

        <form id="loginForm" class="bg-zinc-400 shadow-xl text-white border-blue-500 rounded-xl">
            <input class="px-3 py-2 rounded-md hover:bg-zinc-400 bg-zinc-600 border-2 border-zinc-800 outline-none" type="text" placeholder="username" name="username">
            <input class="px-3 py-2 rounded-md hover:bg-zinc-400 bg-zinc-600 border-2 border-zinc-800 outline-none" type="password" placeholder="password" name="password">
            <input class="px-3 py-2 rounded-md hover:bg-zinc-400 bg-zinc-600 border-2 border-zinc-800 outline-none" type="number" placeholder="age" name="age">

            <!-- Email + Send Verification -->
            <input class="px-3 py-2 rounded-md hover:bg-zinc-400 bg-zinc-600 border-2 border-zinc-800 outline-none" type="email" placeholder="email" name="email" id="emailInput">

            <div style="margin-top: 8px;">
                <button type="button" id="sendVerificationBtn" class="px-3 py-2 rounded-md bg-green-500 text-white">Send Verification Email</button>
            </div>

            <p id="verificationMessage" class="text-white mt-2"></p>
        </form>

        <!-- Google & GitHub login forms remain unchanged -->
        <form class="bg-zinc-400 shadow-xl text-white border-blue-500 rounded-xl" method="get" action="/login_with_google">
            <input class="px-5 py-2 rounded-md bg-blue-500" type="submit" placeholder="Login with google" value="Login with google">
        </form>

        <form class="bg-zinc-400 shadow-xl text-white border-blue-500 rounded-xl" method="get" action="/login_with_github">
            <input class="px-5 py-2 rounded-md bg-blue-500" type="submit" placeholder="Login with github" value="Login with github">
        </form>
    </div>

    <script>
        const sendVerificationBtn = document.getElementById("sendVerificationBtn");
        const emailInput = document.getElementById("emailInput");
        const verificationMessage = document.getElementById("verificationMessage");

        sendVerificationBtn.addEventListener("click", async () => {
            const email = emailInput.value;
            if (!email) {
                verificationMessage.innerText = "Please enter your email first";
                return;
            }

            try {
                const res = await fetch("/send-login-verification", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ email })
                });

                const data = await res.json();
                verificationMessage.innerText = data.message;
            } catch (err) {
                console.error(err);
                verificationMessage.innerText = "Failed to send verification email";
            }
        });
    </script>
</body>
</html>
